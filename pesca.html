<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Pescador de Milagres - Vers√£o Final</title>
    <style>
        :root {
            --gold: #f1c40f;
            --sky: linear-gradient(to bottom, #1a2a3a, #f39c12);
            --sea: linear-gradient(to bottom, #4fc3f7 0%, #0288d1 40%, #012b4d 100%);
        }

        body, html { 
            margin: 0; padding: 0; width: 100%; height: 100%; 
            overflow: hidden; font-family: 'Georgia', serif; background: #000;
            user-select: none; -webkit-user-select: none; touch-action: manipulation;
        }

        #game-container {
            width: 100vw; height: 100vh;
            background: var(--sky);
            display: flex; flex-direction: column; position: relative;
        }

        /* HUD - Interface */
        #hud {
            position: absolute; top: 15px; width: 100%;
            display: flex; flex-wrap: wrap; justify-content: center; gap: 10px; z-index: 100;
        }
        .stat {
            background: rgba(0,0,0,0.7); border: 1px solid var(--gold);
            padding: 6px 15px; border-radius: 20px; color: white; 
            font-size: 14px; backdrop-filter: blur(5px); font-weight: bold;
        }

        /* AMBIENTE MARINHO */
        #sea-area {
            position: absolute; top: 180px; width: 100%; height: calc(100% - 180px);
            background: var(--sea); overflow: hidden;
        }

        .sun-rays {
            position: absolute; inset: 0;
            background: repeating-conic-gradient(from 0deg at 50% -10%, transparent 0deg 15deg, rgba(255,255,255,0.08) 20deg 25deg);
            filter: blur(20px); pointer-events: none;
        }

        /* BARCO COM FLUTUA√á√ÉO REALISTA */
        #boat {
            position: absolute; top: 125px; left: 50%;
            width: 110px; z-index: 50;
            animation: boatSway 5s ease-in-out infinite;
        }

        @keyframes boatSway {
            0%, 100% { transform: translateX(-58%) translateY(0px) rotate(-3deg); }
            50% { transform: translateX(-42%) translateY(-6px) rotate(3deg); }
        }

        /* ANZOL E LINHA */
        #line {
            position: absolute; top: 165px; left: 50%;
            width: 2px; height: 0; background: rgba(255,255,255,0.6);
            transform-origin: top center; z-index: 45;
            /* O anzol segue o balan√ßo do barco suavemente */
            animation: lineSway 5s ease-in-out infinite;
        }

        @keyframes lineSway {
            0%, 100% { transform: translateX(-8px) rotate(0deg); }
            50% { transform: translateX(8px) rotate(0deg); }
        }

        #hook { position: absolute; bottom: -22px; left: -11px; font-size: 22px; filter: drop-shadow(0 2px 4px rgba(0,0,0,0.5)); }

        /* OBJETOS DA CORRENTEZA */
        .item {
            position: absolute; white-space: nowrap;
            user-select: none; pointer-events: none; z-index: 30;
            filter: drop-shadow(0 4px 6px rgba(0,0,0,0.2));
        }

        /* TELAS DE OVERLAY */
        .overlay {
            position: fixed; inset: 0; background: rgba(0,0,0,0.92);
            display: none; flex-direction: column; align-items: center;
            justify-content: center; color: white; z-index: 2000; text-align: center;
        }

        .btn {
            margin-top: 25px; padding: 15px 40px; border-radius: 50px;
            background: var(--gold); border: none; font-weight: bold;
            font-size: 18px; cursor: pointer; color: #000;
        }
    </style>
</head>
<body onclick="lancarAnzol()">

    <div id="game-container">
        <div id="hud">
            <div class="stat">N√çVEL: <span id="level">1</span></div>
            <div class="stat">PONTOS: <span id="score">0</span> / <span id="goal">100</span></div>
            <div class="stat">TEMPO: <span id="timer">60</span>s</div>
        </div>

        <div id="boat">
            <svg viewBox="0 0 100 60">
                <path d="M5,35 L95,35 L85,55 L15,55 Z" fill="#5d4037" />
                <path d="M15,35 L85,35 L75,42 L25,42 Z" fill="#795548" />
                <circle cx="45" cy="22" r="7" fill="#ffdbac" />
                <line x1="52" y1="32" x2="90" y2="5" stroke="#222" stroke-width="3" />
            </svg>
        </div>

        <div id="sea-area">
            <div class="sun-rays"></div>
            <div id="items-container"></div>
        </div>

        <div id="line"><div id="hook">ü™ù</div></div>
    </div>

    <div id="game-over" class="overlay">
        <h1 id="status-title" style="color:var(--gold); font-size: 32px;">PESCARIA ENCERRADA</h1>
        <p id="result-msg" style="font-size: 20px; padding: 0 20px;"></p>
        <button class="btn" onclick="location.reload()">RECOME√áAR</button>
    </div>

<script>
    const itemsContainer = document.getElementById('items-container');
    const line = document.getElementById('line');
    const hook = document.getElementById('hook');
    
    let score = 0, level = 1, goal = 100, timeLeft = 60;
    let gameActive = true, state = 'swing', angle = 0, dir = 1, len = 0;
    let currentCaught = null;
    let activeItems = [];

    const types = [
        { ico: 'üêü', pts: 10, w: 1, speed: 1.8 }, 
        { ico: 'üê†', pts: 25, w: 0.8, speed: 3 },
        { ico: 'üê°', pts: 40, w: 1.5, speed: 1.2 },
        { ico: 'ü¶à', pts: 120, w: 4, speed: 0.8 },
        { ico: 'üëû', pts: -20, w: 2.5, speed: 2 }, 
        { ico: 'ü•´', pts: -15, w: 1.5, speed: 2.5 }
    ];

    function spawnItem() {
        if(!gameActive) return;
        const t = types[Math.floor(Math.random() * types.length)];
        const item = {
            el: document.createElement('div'),
            x: window.innerWidth + 50,
            y: Math.random() * (itemsContainer.offsetHeight - 80),
            t: t,
            speed: (Math.random() * 0.5 + t.speed) + (level * 0.4)
        };
        item.el.className = 'item';
        item.el.innerHTML = t.ico;
        item.el.style.fontSize = (24 + t.w * 8) + 'px';
        item.el.style.top = item.y + 'px';
        itemsContainer.appendChild(item.el);
        activeItems.push(item);
        
        // Intervalo de spawn diminui conforme o n√≠vel aumenta
        setTimeout(spawnItem, Math.max(400, 1600 - (level * 150)));
    }

    function lancarAnzol() {
        if(state === 'swing' && gameActive) state = 'launch';
    }

    function loop() {
        if(!gameActive) return;

        // 1. Mover objetos (Correnteza)
        activeItems.forEach((it, index) => {
            if(it === currentCaught) return;
            it.x -= it.speed;
            it.el.style.left = it.x + 'px';

            if(it.x < -100) {
                it.el.remove();
                activeItems.splice(index, 1);
            }
        });

        // 2. L√≥gica do Anzol (P√™ndulo e Lan√ßamento)
        if(state === 'swing') {
            angle += (1.4 + (level * 0.2)) * dir;
            if(Math.abs(angle) > 75) dir *= -1;
            line.style.transform = `rotate(${angle}deg)`;
        } 
        else if(state === 'launch') {
            len += 12;
            line.style.height = len + 'px';
            
            // Detec√ß√£o de colis√£o
            const hRect = hook.getBoundingClientRect();
            activeItems.forEach(it => {
                if(!currentCaught) {
                    const iRect = it.el.getBoundingClientRect();
                    if(hRect.left < iRect.right && hRect.right > iRect.left && hRect.top < iRect.bottom && hRect.bottom > iRect.top) {
                        currentCaught = it;
                        state = 'back';
                    }
                }
            });

            if(len > window.innerHeight - 220) state = 'back';
        }
        else if(state === 'back') {
            let speedRetract = 10;
            if(currentCaught) speedRetract = Math.max(1.5, 10 / currentCaught.t.w);
            len -= speedRetract;
            line.style.height = len + 'px';

            if(currentCaught) {
                currentCaught.el.style.top = '100%';
                currentCaught.el.style.left = '50%';
                currentCaught.el.style.transform = 'translate(-50%, -50%)';
                hook.appendChild(currentCaught.el);
            }

            if(len <= 0) {
                len = 0; state = 'swing';
                if(currentCaught) {
                    score += currentCaught.t.pts;
                    if(score < 0) score = 0;
                    document.getElementById('score').innerText = score;
                    currentCaught.el.remove();
                    activeItems = activeItems.filter(i => i !== currentCaught);
                    currentCaught = null;
                    checkLevel();
                }
            }
        }
        requestAnimationFrame(loop);
    }

    function checkLevel() {
        if(score >= goal) {
            level++;
            goal += 150 + (level * 50);
            timeLeft += 20; // Recompensa de tempo
            document.getElementById('level').innerText = level;
            document.getElementById('goal').innerText = goal;
            
            // Efeito visual de mudan√ßa de profundidade
            document.getElementById('sea-area').style.filter = `hue-rotate(${level * 15}deg) brightness(${1 - level*0.05})`;
        }
    }

    const clock = setInterval(() => {
        if(!gameActive) return;
        timeLeft--;
        document.getElementById('timer').innerText = timeLeft;
        if(timeLeft <= 0) endGame();
    }, 1000);

    function endGame() {
        gameActive = false;
        clearInterval(clock);
        document.getElementById('game-over').style.display = 'flex';
        document.getElementById('result-msg').innerText = `Excelente! Voc√™ atingiu o N√≠vel ${level} com uma pontua√ß√£o de ${score}.`;
    }

    // In√≠cio
    spawnItem();
    loop();
</script>
</body>
</html>
